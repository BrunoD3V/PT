@using Jmelosegui.Mvc.GoogleMap
@using PTurismo.Helpers
@using System.Web.Script.Serialization;
@model PTurismo.ViewModels.PoiViewModel

@{
    ViewBag.Title = "Home Page";
}



<div class="row">
    <div class="container-fluid">
        <div class="col-md-6">
            @(Html.GoogleMap()
              .Name("map")
              .Height(800)
              .ApiKey("AIzaSyAYC419uGMGyG-Lhc5gPRxzRm1q2Uu1b-4")
              .Center(c => c.Latitude(41.130325).Longitude(-7.097716))
              .FitToMarkersBounds((bool)ViewData["FitToMarkersBounds"])
              
              .Draggable((bool)ViewData["draggable"])
              .Markers(m =>
              {

                  foreach (var p in Model.Pois)
                  {
                      m.Add().Latitude(p.latitude).Longitude(p.longitude);

                  }
              })
              .MarkerEvents(events => events.OnMarkerClick("markerClick"))
            )
        </div>
        <div id ="Descricao" class="col-md-6">
           
        </div>
    </div>

</div>

@section scripts
{
    @(Html.GoogleMap().ScriptRegistrar())
    <script type="text/javascript">
        var pois = @JavaScriptConvert.SerializeObject(@Model.Pois);
        
        
        function markerClick(args) {

            if (args.eventName === 'click') {
                

                $('#Descricao').html(pois[args.id].nome);
                alert(pois[args.id].nome);
            }

        }


    </script>
}